<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Will You Be My Valentine? ğŸ’</title>
  <link rel="stylesheet" href="style.css" />
  <script src="app.js" defer></script>
</head>

<body>
  <div id="bg"></div>

  <main class="card" id="app">
    <h1 id="title">Loadingâ€¦</h1>
    <p id="subtitle" class="muted"></p>

    <div id="stage" class="stage"></div>
    <div id="controls" class="controls"></div>
  </main>

  <!-- Hidden background music -->
  <audio id="bgm" loop preload="auto" playsinline>
    <source src="audio.mp3" type="audio/mpeg" />
  </audio>

  <!-- Tap-to-play overlay (shows only if autoplay is blocked) -->
  <div id="musicGate" class="musicGate hidden">
    <button id="musicGateBtn" class="btn">ğŸ’– Tap to start our song</button>
  </div>

  <script>
    const bgm = document.getElementById("bgm");
    const gate = document.getElementById("musicGate");
    const gateBtn = document.getElementById("musicGateBtn");

    async function startMusic() {
      try {
        bgm.volume = 0.8;
        await bgm.play();
        gate.classList.add("hidden");
      } catch (e) {
        gate.classList.remove("hidden");
        console.warn("Music blocked or failed:", e);
      }
    }

    // Button works (user gesture)
    gateBtn.addEventListener("click", startMusic);

    // First interaction anywhere starts music (best UX)
    window.addEventListener("pointerdown", startMusic, { once: true });
    window.addEventListener("touchstart", startMusic, { once: true });
    window.addEventListener("keydown", startMusic, { once: true });
  </script>
</body>
</html>
